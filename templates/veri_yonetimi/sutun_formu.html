{% extends 'base.html' %}

{% block title %}
    {% if is_edit %}SÃ¼tun GÃ¼ncelle{% else %}SÃ¼tun Ekle{% endif %} - {{ app_name|default:"DVP" }}
{% endblock %}

{% block content %}
<div class="min-h-screen p-4">
    <div class="w-full">
        
        <!-- Test Veri Butonu -->
        {% if not is_edit %}
        <div class="text-center mb-6">
            <button type="button" onclick="generateFakeData()" 
                    class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">
                ğŸ² Test Verisi
            </button>
        </div>
        {% endif %}
        
        <!-- Form -->
        <form method="post" class="space-y-4">
            {% csrf_token %}
            
            <!-- Error Messages -->
            {% if form.errors %}
                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="text-red-600">âš ï¸</span>
                        <h3 class="text-red-800 font-medium">Form hatalarÄ± bulundu</h3>
                    </div>
                    <ul class="text-red-700 text-sm space-y-1">
                        {% for field, errors in form.errors.items %}
                            {% for error in errors %}
                                <li>â€¢ {{ error }}</li>
                            {% endfor %}
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}

            <!-- Form Fields -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- SÃ¼tun AdÄ± -->
                <div class="md:col-span-3">
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        ğŸ“ SÃ¼tun AdÄ±
                        <span class="text-red-500">*</span>
                    </label>
                    <input type="text" 
                           name="ad" 
                           value="{{ form.ad.value|default:'' }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"
                           placeholder="Ä°l AdÄ±, BÃ¶lge, NÃ¼fus..."
                           required>
                    {% if form.ad.errors %}
                        <div class="mt-1 text-xs text-red-600">{{ form.ad.errors.0 }}</div>
                    {% endif %}
                </div>
                
                <!-- SÃ¼tun Tipi -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        ğŸ·ï¸ SÃ¼tun Tipi
                    </label>
                    <select name="tip" 
                            class="w-full px-3 py-2 border border-gray-300 rounded focus:ring-1 focus:ring-blue-500">
                        <option value="dinamik" {% if form.tip.value == 'dinamik' %}selected{% endif %}>Dinamik SÃ¼tun</option>
                        <option value="kurulacak" {% if form.tip.value == 'kurulacak' %}selected{% endif %}>Kurulacak Cihaz SayÄ±sÄ±</option>
                        <option value="kurulan" {% if form.tip.value == 'kurulan' %}selected{% endif %}>Kurulan Cihaz SayÄ±sÄ±</option>
                        <option value="arizali" {% if form.tip.value == 'arizali' %}selected{% endif %}>ArÄ±zalÄ± Cihaz SayÄ±sÄ±</option>
                        <option value="tamamlanma" {% if form.tip.value == 'tamamlanma' %}selected{% endif %}>Tamamlanma Durumu</option>
                    </select>
                    {% if form.tip.errors %}
                        <div class="mt-1 text-xs text-red-600">{{ form.tip.errors.0 }}</div>
                    {% endif %}
                </div>
                
                <!-- MenÃ¼ Tipi -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        ğŸ“± MenÃ¼ Tipi
                    </label>
                    <select name="menu_tipi" 
                            class="w-full px-3 py-2 border border-gray-300 rounded focus:ring-1 focus:ring-blue-500">
                        <option value="genel" {% if form.menu_tipi.value == 'genel' %}selected{% endif %}>Genel (TÃ¼m MenÃ¼ler)</option>
                        <option value="veri_listesi" {% if form.menu_tipi.value == 'veri_listesi' %}selected{% endif %}>Veri Listesi</option>
                        <option value="cihaz_turleri" {% if form.menu_tipi.value == 'cihaz_turleri' %}selected{% endif %}>Cihaz TÃ¼rleri</option>
                    </select>
                    {% if form.menu_tipi.errors %}
                        <div class="mt-1 text-xs text-red-600">{{ form.menu_tipi.errors.0 }}</div>
                    {% endif %}
                </div>
                
                <!-- SÄ±ra -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        ğŸ”¢ SÄ±ra
                    </label>
                    <input type="number" 
                           name="sÄ±ra" 
                           value="{{ form.sÄ±ra.value|default:'1' }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"
                           placeholder="0, 1, 2, 3..."
                           min="0"
                           step="1">
                    {% if form.sÄ±ra.errors %}
                        <div class="mt-1 text-xs text-red-600">{{ form.sÄ±ra.errors.0 }}</div>
                    {% endif %}
                </div>
                
                <!-- GeniÅŸlik -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        ğŸ“ GeniÅŸlik
                    </label>
                    <input type="text" 
                           name="genislik" 
                           value="{{ form.genislik.value|default:'auto' }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"
                           placeholder="auto, 100px, 20%">
                    {% if form.genislik.errors %}
                        <div class="mt-1 text-xs text-red-600">{{ form.genislik.errors.0 }}</div>
                    {% endif %}
                </div>
                
                <!-- Hizalama -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        â†”ï¸ Hizalama
                    </label>
                    <select name="hizalama" 
                            class="w-full px-3 py-2 border border-gray-300 rounded focus:ring-1 focus:ring-blue-500">
                        <option value="left" {% if form.hizalama.value == 'left' %}selected{% endif %}>Sol</option>
                        <option value="center" {% if form.hizalama.value == 'center' %}selected{% endif %}>Orta</option>
                        <option value="right" {% if form.hizalama.value == 'right' %}selected{% endif %}>SaÄŸ</option>
                    </select>
                    {% if form.hizalama.errors %}
                        <div class="mt-1 text-xs text-red-600">{{ form.hizalama.errors.0 }}</div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Checkboxes -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 pt-4">
                <div class="flex items-center">
                    <input type="checkbox" 
                           name="aktif" 
                           id="aktif"
                           {% if form.aktif.value %}checked{% endif %}
                           class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label for="aktif" class="ml-2 text-sm text-gray-700">
                        âœ… SÃ¼tun Aktif
                    </label>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" 
                           name="gorunur" 
                           id="gorunur"
                           {% if form.gorunur.value %}checked{% endif %}
                           class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label for="gorunur" class="ml-2 text-sm text-gray-700">
                        ğŸ‘ï¸ SÃ¼tun GÃ¶rÃ¼nÃ¼r
                    </label>
                </div>
            </div>
            
            <!-- Info Text -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                <p class="text-sm text-blue-800">
                    ğŸ’¡ <strong>Bilgi:</strong> Aktif olmayan sÃ¼tunlar tabloda gÃ¶rÃ¼nmez ve veri giriÅŸinde kullanÄ±lamaz.
                </p>
            </div>

            <!-- Action Buttons -->
            <div class="flex gap-3 pt-4">
                <button type="submit" 
                        class="flex-1 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors">
                    {% if is_edit %}ğŸ’¾ GÃ¼ncelle{% else %}â• SÃ¼tun Ekle{% endif %}
                </button>
                <a href="{% url 'veri_yonetimi:sutun_listesi' %}" 
                   class="px-4 py-2 border border-gray-300 text-gray-700 rounded hover:bg-gray-50 transition-colors">
                   âŒ Ä°ptal
                </a>
            </div>
        </form>
        
        <!-- SÃ¼tun Bilgileri (Sadece dÃ¼zenleme modunda) -->
        {% if is_edit and sutun %}
        <div class="mt-8 bg-gray-50 rounded-lg p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“‹ SÃ¼tun Bilgileri</h3>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 text-sm">
                <div>
                    <span class="font-medium text-gray-700">OluÅŸturulma Tarihi:</span>
                    <span class="text-gray-600 ml-2">{{ sutun.oluÅŸturulma_tarihi|date:"d.m.Y H:i" }}</span>
                </div>
                <div>
                    <span class="font-medium text-gray-700">SÄ±ra:</span>
                    <span class="text-gray-600 ml-2">{{ sutun.sÄ±ra }}</span>
                </div>
                <div>
                    <span class="font-medium text-gray-700">Tip:</span>
                    <span class="text-gray-600 ml-2">{{ sutun.get_tip_display }}</span>
                </div>
                <div>
                    <span class="font-medium text-gray-700">MenÃ¼:</span>
                    <span class="text-gray-600 ml-2">{{ sutun.get_menu_tipi_display }}</span>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script>
function generateFakeData() {
    // SÃ¼tun adlarÄ± listesi
    const sutunAdlari = ['Ä°l AdÄ±', 'BÃ¶lge', 'NÃ¼fus', 'YÃ¼zÃ¶lÃ§Ã¼mÃ¼', 'Ä°klim', 'Ekonomi', 'Turizm', 'EÄŸitim', 'SaÄŸlÄ±k', 'UlaÅŸÄ±m'];
    const randomAd = sutunAdlari[Math.floor(Math.random() * sutunAdlari.length)];
    
    // Rastgele deÄŸerler
    const randomSira = Math.floor(Math.random() * 10) + 1;
    const randomGenislik = ['auto', '100px', '150px', '200px', '20%'][Math.floor(Math.random() * 5)];
    
    // Form alanlarÄ±nÄ± doldur
    document.querySelector('input[name="ad"]').value = randomAd;
    document.querySelector('input[name="sÄ±ra"]').value = randomSira;
    document.querySelector('input[name="genislik"]').value = randomGenislik;
    
    // Checkbox'larÄ± iÅŸaretle
    document.querySelector('input[name="aktif"]').checked = true;
    document.querySelector('input[name="gorunur"]').checked = true;
    
    alert('ğŸ² Test verileri eklendi!');
}
</script>
{% endblock %}
